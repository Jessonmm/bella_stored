    {% load static %}
    <!DOCTYPE html>
    <html class="no-js" lang="en">
    <style>
    body{
    margin: 0%;
    padding:0%;
    /* overflow-y: hidden; */
    overflow-x: hidden;
}
.icon.anm.anm-bag-l {
    font-size: 22px; /* Adjust the size value to your desired size */
  }
.site-header__actions {
    display: flex;
    align-items: center;
}

.site-cart {
    margin-right: 10px; /* Add some spacing between the cart icon and search bar */
}

.site-header__search {
    display: flex;
    align-items: center;
}

.site-header__search form {
    display: flex;
    align-items: center;
}

/* Increase the width of the search bar */
.site-header__search input[type="text"] {
    width: 130px; /* Adjust the width as needed */
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 5px;
    margin-right: 10px; /* Add some spacing between the search bar and search button */
}

.search-button {
    background-color: #333;
    border: none;
    color: #fff;
    cursor: pointer;
    padding-left: 5px;
    height:40px;
    font-size: 16px;
}

.search-button:hover {
    background-color: #555;
}


</style>
    <!-- belle/login.html   11 Nov 2019 12:22:27 GMT -->
    <head>
        <!-- Add these inside the <head> tag -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">


<!-- Add these just before the closing </body> tag -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Payment</title>
    <meta name="description" content="description">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon -->
    <link rel="shortcut icon" href= {% static '/images/favicon.png' %} >
    <!-- Plugins CSS -->
    <link rel="stylesheet" href= {% static '/css/plugins.css' %}>
    <!-- Bootstap CSS -->
    <link rel="stylesheet" href= {% static '/css/bootstrap.min.css' %}>
    <!-- Main Style CSS -->
    <link rel="stylesheet" href= {% static '/css/style.css' %}>
    <link rel="stylesheet" href=  {% static '/css/responsive.css' %}>
    </head>
<body class="template-product belle">
	<div class="pageWrapper">
        <!--Search Form Drawer-->
        <div class="search">
            <div class="search__form">
                <form class="search-bar__form" action="#">
                    <button class="go-btn search__button" type="submit"><i class="icon anm anm-search-l"></i></button>
                    <input class="search__input" type="search" name="q" value="" placeholder="Search entire store..." aria-label="Search" autocomplete="off">
                </form>
                <button type="button" class="search-trigger close-btn"><i class="icon anm anm-times-l"></i></button>
            </div>
        </div>
        <!--End Search Form Drawer-->
        <!--Top Header-->
       <div class="top-header">
    <div class="container-fluid">
        <div class="row">
            <div class="col-10 col-sm-8 col-md-5 col-lg-4">
                <div class="currency-picker">
                    <ul id="currencies">
                        <!-- Add your currency items here if needed -->
                    </ul>
                </div>
                <div class="language-dropdown">
                    <!-- Add your language dropdown items here if needed -->
                </div>
                <p class="phone-no">ph. 6238927277</p>
            </div>
            <div class="col-sm-4 col-md-4 col-lg-4 d-none d-lg-none d-md-block d-lg-block">
                <div class="text-center">
                    <p class="top-header_middle-text"> Created by:Jesson mm</p>
                </div>
            </div>
            <div class="col-2 col-sm-4 col-md-3 col-lg-4 text-right">
                <span class="user-menu d-block d-lg-none">
                    <i class="anm anm-user-al" aria-hidden="true"></i>
                </span>
                <ul class="customer-links list-inline">
                    {% if  request.user.is_authenticated %}
                    <li><a href="{% url 'logout' %}">logout</a></li>
                    {% else %}
                    <li><a href="{% url 'register' %}">register</a></li>
                    <li><a href="{% url 'login' %}">login</a></li>
                    {% endif %}

                </ul>
            </div>
        </div>
    </div>
</div>

        <!--End Top Header-->
        <!--Header-->
        <div class="header-wrap animated d-flex">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <!--Desktop Logo-->
                    <div class="logo col-md-2 col-lg-2 d-none d-lg-block">
                        <a href="{% url 'home' %}">
                            <img src="{% static '/images/logo.svg' %}" alt="Belle Multipurpose Html Template" title="Belle Multipurpose Html Template" />
                        </a>
                    </div>
                    <!--End Desktop Logo-->
                    <div class="col-2 col-sm-3 col-md-3 col-lg-8">
                        <div class="d-block d-lg-none">
                            <button type="button" class="btn--link site-header__menu js-mobile-nav-toggle mobile-nav--open">
                                <i class="icon anm anm-times-l"></i>
                                <i class="anm anm-bars-r"></i>
                            </button>
                        </div>
                        <!--Desktop Menu-->
                        <nav class="grid__item" id="AccessibleNav"><!-- for mobile -->
                            <ul id="siteNav" class="site-nav medium center hidearrow">
                                <li class="lvl1 parent megamenu"><a href="{% url 'home' %}">Home <i class="anm anm-angle-down-l"></i></a>

                                <li class="lvl1 parent megamenu"><a href="{% url 'store' %}">Shop <i class="anm anm-angle-down-l"></i></a>




                                  {% if  request.user.is_authenticated %}
                             <li class="lvl1 parent dropdown"><a href="#">Profile <i class="anm anm-angle-down-l"></i></a>
                          <ul class="dropdown">
                           <li><a href="{% url 'profiles' %}" class="site-nav">My Account</a></li>
                          <li><a href="{% url 'change-password' %}" class="site-nav">Change password</a></li>
                            <li><a href="{% url 'my_address' %}" class="site-nav">My Address</a></li>
                            <li><a href="{% url 'my-orders' %}" class="site-nav">Orders</a></li>
                            <li><a href="{% url 'cart' %}" class="site-nav">Cart Page</a> </li>
                            <li><a href="{% url 'wallet' %}" class="site-nav">Wallet</a> </li>>


                          </ul>
                                </li>
                          {% endif %}


                        </nav>
                        <!--End Desktop Menu-->
                    </div>
                    <div class="col-6 col-sm-6 col-md-6 col-lg-2 d-block d-lg-none mobile-logo">
                        <div class="logo">
                            <a href="index.html">
                                <img src="{% static '/images/logo.svg' %}" alt="Belle Multipurpose Html Template" title="Belle Multipurpose Htmlss Template" />
                            </a>
                        </div>
                    </div>
             <div class="col-4 col-sm-3 col-md-3 col-lg-2">
<div class="col-4 col-sm-3 col-md-3 col-lg-2 site-header__actions">
    <!-- Cart Icon -->
    <div class="site-cart">
        <a href="{% url 'cart' %}" class="site-nav" title="Cart">
            <i class="icon anm anm-bag-l"></i>
        </a>
        <!-- End Minicart Popup -->
    </div>

    <!-- Search Form -->

</div>

                    </div>
                </div>
            </div>
        </div>
        <!--End Header-->
        <div class="mobile-nav-wrapper" role="navigation">
		<div class="closemobileMenu"><i class="icon anm anm-times-l pull-right"></i> Close Menu</div>
        <ul id="MobileNav" class="mobile-nav">
        	<li class="lvl1 parent megamenu"><a href="{% url 'home' %}">Home </i></a>

        </li>
        	<li class="lvl1 parent megamenu"><a href="{% url 'store' %}">Shop </i></a>

            </li>


                                  {% if  request.user.is_authenticated %}
                             <li class="lvl1 parent dropdown"><a href="#">Profile <i class="anm anm-angle-down-l"></i></a>
                          <ul class="dropdown">
                           <li><a href="{% url 'profiles' %}" class="site-nav">My Account</a></li>
                          <li><a href="{% url 'change-password' %}" class="site-nav">Change password</a></li>
                            <li><a href="{% url 'my_address' %}" class="site-nav">My Address</a></li>
                            <li><a href="{% url 'my-orders' %}" class="site-nav">Orders</a></li>
                            <li><a href="{% url 'cart' %}" class="site-nav">Cart Page</a> </li>
                            <li><a href="{% url 'wallet' %}" class="site-nav">Wallet</a> </li>

                          </ul>
                                </li>
                          {% endif %}


      </ul>
	</div>
	<!--End Mobile Menu-->

    <!--Body Content-->
    <div id="page-content">
    	<!--Page Title-->
    	<div class="page section-header text-center">
			<div class="page-title">
        		<div class="wrapper"><h1 class="page-width">Payment</h1></div>
      		</div>
		</div>
        <!--End Page Title-->
          <div class="cart-section my-5">
                <!-- Start Coupon Start -->

        <div class="container">
            <div class="row">

                    <div class="col-lg-7 clo-md-6">
                        <div class="coupon_code left" data-aos="fade-up" data-aos-delay="200">
                            <div class="card">
                                <h5 class="card-header text-center font-weight-bold">Billing Address</h5>
                                <div class="card-body">

                                  <p class="card-text mb-0"><b>Full Name:</b>{{order.full_name}}</p>

                                  <p class="card-text mb-0"><b>Address:</b>{{order.full_address}}</p>
                                  <p class="card-text mb-0"><b>Place:</b>{{order.country}},{{order.state}},{{order.city}}, {{order.district}}</p>
                                  <p class="card-text mb-0">    </p>
                                  <p class="card-text mb-0"><b>Gmail:</b>{{order.email}}</p>
                                  <p class="card-text mb-0"><b>Phone number:</b>{{order.phone_number}}</p>
                                  {% if order.order_note %}
                                    <b>Order Note:</b> {{order.order_note}}
                                   {%endif%}
                                </div>
                            </div>



                        <div class="card mt-3">
                            <h5 class="card-header text-center font-weight-bold">Review Products</h5>
                            <div class="card-body">
                                <div class="order_table table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Product</th>
                                                <th>Image</th>
                                                <th>Total</th>
                                            </tr>
                                        </thead>
                                        {% for cart_item in cart_items %}
                                        <tbody>
                                            <tr>
                                                <td>{{ cart_item.product.product_name }}
                                                  <br>

                                                  {% for item in cart_item.variations.all %}

                                                  {{item.variation_category | capfirst}} : {{item.variation_value | capfirst}}

                                                  {% endfor %}
                                                  <strong> ×{{ cart_item.quantity }}</strong></td>
                                                <td class="product_thumb"><a href="#"><img
                                                    src="{{ cart_item.product.image_1.url }}" style="width: 60px;"
                                                    alt="img"></a>
                                                </td>
                                                <td><p class="mt-3"> ₹{{ cart_item.sub_total }}</p> </td>


                                            </tr>
                                        </tbody>
                                        {%endfor%}
                                    </table>
                                </div>
                            </div>
                        </div>

                    </div>


                </div>
                <div class="col-lg-5 col-md-6 ml-auto" id="amount-caontainer">
                    <div class="coupon_code right" data-aos="fade-up" data-aos-delay="400">
                        <h3 class="text-center font-weight-bold mb-4">Cart Totals</h3>
                        <div class="coupon_inner container">

                              <div class="cart_subtotal d-flex justify-content-between">
                                <p>Subtotal :</p>
                                <span class="cart_amount">₹{{total}}.00</span>
                            </div>
                            <div class="cart_subtotal d-flex justify-content-between">
                                <p>Tax :</p>
                                <span class="cart_amount">₹{{tax}}</span>
                            </div>
                              <div class="cart_subtotal d-flex justify-content-between">
                                <p>Shipping :</p>
                                  {% if shipping == 0 %}
                                <span class="cart_amount">free shipping</span>
                                  {% else %}
                                <span class="cart_amount">₹{{shipping}}</span>
                                   {% endif %}
                            </div>

                            {% if coupon_discount %}
                            <div class="cart_subtotal d-flex justify-content-between">
                                <p>Discount :</p>
                                <span class="cart_amount">₹{{coupon_discount}}</span>
                            </div>
                             {% endif %}


                            <div class="cart_subtotal d-flex justify-content-between">
                                <p>Grand Total :</p>
                                <span class="cart_amount"><b>₹{{order.order_total}}</b></span>
                            </div>


                            <div class="container-fluid mt-4">
                                    <div class="row">
                                        <button  class="btn ml-3 mb-3 col-11 btn-warning" style="height: 40px;" data-toggle="modal" data-target="#exampleModal">
                                            <b>CASH ON DELIVERY</b>
                                        </button>
                                        <button id="rzp-button1" class="btn btn-light ml-3 mb-3 col-11" style="height: 40px;" >
                                             <b>RAZORPAY</b>
                                     </button>
                                        <!-- paypal button -->
                                        <div id="paypal-button-container" class="col-12"></div>
                                    </div>
                                    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                      <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                          <div class="modal-header">
                                            <h5 class="modal-title" id="exampleModalLabel">CASH ON DELIVERY</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                              <span aria-hidden="true">&times;</span>
                                            </button>
                                          </div>
                                          <div class="modal-body">
                                            <p>Confirm Your Order ?</p>
                                          </div>
                                          <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                            <a href="{% url 'cash_on_delivery'  order_number  %}" type="button" class="btn btn-primary">Confirm</a>
                                          </div>
                                        </div>
                                      </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>
            </div>
        </div>
</div> <!-- ...:::: End Cart Section:::... -->
    <!--End Body Content-->

    <!--Footer-->
   <footer id="footer">
        <div class="newsletter-section">


            </div>
        </div>
        <div class="site-footer">
        	<div class="container">
     			<!--Footer Links-->
            	<div class="footer-top">
                	<div class="row">
                    	<div class="col-12 col-sm-12 col-md-3 col-lg-3 footer-links">
                        	<h4 class="h4">Quick Shop</h4>
                            <ul>
                            	<li><a href="#">Women</a></li>
                                <li><a href="#">Men</a></li>
                                <li><a href="#">Kids</a></li>
                                <li><a href="#">Sportswear</a></li>
                                <li><a href="#">Sale</a></li>
                            </ul>
                        </div>
                        <div class="col-12 col-sm-12 col-md-3 col-lg-3 footer-links">
                        	<h4 class="h4">Informations</h4>
                            <ul>
                            	<li><a href="#">About us</a></li>
                                <li><a href="#">Careers</a></li>
                                <li><a href="#">Privacy policy</a></li>
                                <li><a href="#">Terms &amp; condition</a></li>
                                <li><a href="#">My Account</a></li>
                            </ul>
                        </div>
                        <div class="col-12 col-sm-12 col-md-3 col-lg-3 footer-links">
                        	<h4 class="h4">Customer Services</h4>
                            <ul>
                            	<li><a href="#">Request Personal Data</a></li>
                                <li><a href="#">FAQ's</a></li>
                                <li><a href="#">Contact Us</a></li>
                                <li><a href="#">Orders and Returns</a></li>
                                <li><a href="#">Support Center</a></li>
                            </ul>
                        </div>
                        <div class="col-12 col-sm-12 col-md-3 col-lg-3 footer-links">
                        	<h4 class="h4">Contact Us</h4>
                               <ul>
                            	<li><a href="#">Jesson mm</a></li>
                                <li><a href="#">6238927277</a></li>
                                <li><a href="#">www.jessommm0@gmail.com</a></li>

                            </ul>

                        </div>
                    </div>
                </div>
                <!--End Footer Links-->
                <hr>
                <div class="footer-bottom">
                	<div class="row">
                    	<!--Footer Copyright-->
	                	<div class="row">
	                	<span class="col-12 col-sm-12 col-md-12 col-lg-12 copyright text-center"><span></span> <a href="templateshub.net"><a class="social-icons__link" href="https://www.instagram.com/___jesson_mm___/" target="_blank" title="Belle Multipurpose Bootstrap 4 Template on Instagram"><i class="icon icon-instagram"></i> <span class="icon__fallback-text">Instagram</span></a></a></span>
                        <!--End Footer Copyright-->
                    </div>
                        <!--End Footer Payment Icon-->
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <span id="site-scroll"><i class="icon anm anm-angle-up-r"></i></span>
    <!--End Scoll Top-->

     <!-- Including Jquery -->
<script src="{% static 'js/vendor/jquery-3.3.1.min.js' %}"></script>
<script src="{% static 'js/vendor/jquery.cookie.js' %}"></script>
<script src="{% static 'js/vendor/modernizr-3.6.0.min.js' %}"></script>
<script src="{% static 'js/vendor/wow.min.js' %}"></script>
<!-- Including Javascript -->
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<script src="{% static 'js/plugins.js' %}"></script>

<script src="{% static 'js/lazysizes.js' %}"></script>
<script src="{% static 'js/main.js' %}"></script>


</div>
</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


    <!--paypal-->
<script>

    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
        }

    var amount=Number("{{grand_total}}");

    amount =  amount/81.52;
    amount = amount.toFixed(2)

    var url = "{% url 'payments' %}"
    var csrftoken = getCookie('csrftoken');
    var orderID = "{{order.order_number}}"
    var payment_method = 'PayPal'
    var redirect_url = "{% url 'payments_completed' %}"

    const fundingSources = [
      paypal.FUNDING.PAYPAL,
      ]

    for (const fundingSource of fundingSources) {
      const paypalButtonsComponent = paypal.Buttons({
        fundingSource: fundingSource,

        // optional styling for buttons
        // https://developer.paypal.com/docs/checkout/standard/customize/buttons-style-guide/
        style: {
            color:  'blue',
            shape:  'rect',
            label:  'pay',
            height: 50
        },

        // set up the transaction
        // Set up the transaction
        createOrder: function(data, actions) {
            return actions.order.create({
                purchase_units: [{
                    amount: {
                        value: amount
                    }
                }]
            });
        },

        // Finalize the transaction
        onApprove: function(data, actions) {
            return actions.order.capture().then(function(details) {
                // Show a success message to the buyer
                console.log(details);
                sendData1();
                function sendData1(){
                    fetch(url, {
                        method : "POST",
                        headers: {
                            "Content-type": "application/json",
                            "X-CSRFToken": csrftoken,
                        },
                        body: JSON.stringify({
                            orderID: orderID,
                            transID: details.id,
                            status: 'completed',
                            paymode : "PayPal"
                        }),
                    })
                .then((response) => response.json())
                .then((data) => {
                        window.location.href = redirect_url + '?order_number='+data.order_number+'&payment_id='+data.transID;
                    });
                }
            });
        }


    })

      if (paypalButtonsComponent.isEligible()) {
        paypalButtonsComponent
          .render('#paypal-button-container')
          .catch((err) => {
            console.error('PayPal Buttons failed to render')
          })
      } else {
        console.log('The funding source is ineligible')
      }
    }
  </script>


    <!-- Razer pay -->
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<script>
    var orderID = "{{order_number}}"
    var grand_total = "{{grand_total}}"
    var csrftoken = getCookie('csrftoken');
    var redirect_url = "{% url 'payments_completed' %}"
    var url1 = "{% url 'razorpay' %}";
    var url = "{% url 'payments' %}"
    function sample(response){
        // var payment_method = response.payment.payment_method
      var options = {
          "key": "rzp_test_M9I4y7eqGrotVX",

          "amount":response.payment.amount ,
          "currency": "INR",
          "name": "Belle store",
          "description": "purchase test 1",
          "image": "{% static '/images/logo.svg' %}",
          "order_id": response.payment.id,

          "handler": function (response2){
              sendData(response,response2);
          },
          "prefill": {
              "name": "belle",
              "email": "hello@gmail.com",
              "contact": "6238927277"
          },
          "notes": {
              "address": "Razorpay Corporate Office"
          },
          "theme": {
              "color": "#3399cc"
          }
      };
      var rzp1 = new Razorpay(options);
        rzp1.open();
    //     e.preventDefault();
    //   rzp1.on('payment.failed', function (response){
    //           alert(response.error.reason);
    //           //alert(response.error.metadata.order_id);
    //           //alert(response.error.metadata.payment_id);
    //   });
    }
      document.getElementById('rzp-button1').onclick = function(e){
          fetch(url1,{
            method : "POST",
            headers : {
                "Content-type":"application/json",
                "X-CSRFToken": csrftoken,
            },
            body:JSON.stringify({
                amount: grand_total,
            }),
        }).then((response)=>response.json()).then(response=>{
            console.log(response)
             sample(response)

          })
          e.preventDefault();
      }

      function sendData(response,response2){
                console.log(response.razorpay_payment_id)
                  fetch(url,{
                      method : "POST",
                      headers : {
                          "Content-type":"application/json",
                          "X-CSRFToken": csrftoken,
                      },
                      body:JSON.stringify({
                          orderID: orderID,
                          transID: response2.razorpay_payment_id,
                        //   razorpay_payment_id:response.razorpay_payment_id,
                        //   razorpay_order_id:response.razorpay_order_id,
                        //   razorpay_signature:response.razorpay_signature,
                        //   amount_paid:amount_paid,
                          status:'completed',
                          paymode:'RazerPay'
                      }),
                  })
                  .then(response => response.json())
                  .then(data => {
                      window.location.href = redirect_url + '?order_number='+data.order_number +'&payment_id='+data.transID;

                  });
              }
    </script>
</html>